import sqlite3

conn = sqlite3.connect('covid_data.db')
c = conn.cursor()

# perform a query to calculate something from the data
c.execute('''SELECT strftime('%w', date) as day_of_week, count(*) as num_items
             FROM daily_stats
             GROUP BY day_of_week''')
results = c.fetchall()

# write the calculated data to a file as text
with open('output.txt', 'w') as f:
    for row in results:
        f.write(f'{row[0]}: {row[1]}\n')

# perform a join to select data for visualization
c.execute('''SELECT daily_stats.date, daily_stats.cases, race_ethnicity.race, race_ethnicity.cases
             FROM daily_stats
             JOIN race_ethnicity ON daily_stats.id = race_ethnicity.id
             WHERE daily_stats.date = 20220420''')
results = c.fetchall()

conn.close()
